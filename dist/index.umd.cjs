(function(J){typeof define=="function"&&define.amd?define(J):J()})(function(){"use strict";const J=new Map;function q(e){let t=J.get(e);return t===void 0&&(t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),J.set(e,t)),t}function fe(e){return`<${String(e.tagName).toLowerCase()}>`}function ue(e,t){e.nodeType===globalThis.Node.ELEMENT_NODE&&(t(e),e.shadowRoot&&ue(e.shadowRoot,t));const n=globalThis.document.createTreeWalker(e,globalThis.NodeFilter.SHOW_ELEMENT,null,!1);for(;n.nextNode();){const o=n.currentNode;t(o),o.shadowRoot&&ue(o.shadowRoot,t)}}const de=Promise.resolve(),Oe=new WeakMap,Ne=ue.name==="walkInShadow",K=new Set;function He(e){K.size||de.then(Xt),K.add(e)}function Ut(e){K.delete(e)}function Xt(){for(const e of K)try{e()}catch(t){console.error(t)}K.clear()}const G=new WeakMap,H=new Set;function Ye(e){const t=new Set,n=t.values();for(;e;){if(e.resolved=!1,e.deps){for(const o of e.deps)o.contexts.delete(e);e.deps.clear()}if(e.contexts)for(const o of e.contexts)H.has(o)||(t.add(o),e.contexts.delete(o));e.observe&&He(e.observe),e=n.next().value}}function z(e,t){let n=G.get(e);n||(n=new Map,G.set(e,n));let o=n.get(t);return o||(o={key:t,target:e,value:void 0,lastValue:void 0,resolved:!1,contexts:void 0,deps:void 0,observe:void 0},n.set(t,o)),o}function Qe(e){const t=G.get(e);return t?[...t.values()]:[]}let j=null;function D(e,t,n){const o=z(e,t);if(j&&(o.contexts||(o.contexts=new Set),j.deps||(j.deps=new Set),o.contexts.add(j),j.deps.add(o)),o.resolved)return o.value;const i=j;try{if(H.has(o))throw Error(`Circular get invocation is forbidden: '${t}'`);j=o,H.add(o),o.value=n(e,o.value),o.resolved=!0,j=i,H.delete(o)}catch(r){throw j=i,H.delete(o),j&&(j.deps.delete(o),o.contexts.delete(j)),r}return o.value}function pe(e,t,n,o){const i=z(e,t),r=n(e,o,i.value);r!==i.value&&(i.value=r,Ye(i))}function Jt(e,t,n,o){const i=z(e,t);i.observe=()=>{const r=D(e,t,n);r!==i.lastValue&&(o(e,r,i.lastValue),i.lastValue=r)};try{i.observe()}catch(r){console.error(r)}return()=>{Ut(i.observe),i.observe=void 0,i.lastValue=void 0}}const he=new Set;function qt(e){he.size||setTimeout(()=>{for(const t of he)if(!t.contexts||t.contexts.size===0){if(t.deps)for(const o of t.deps)o.contexts.delete(t);G.get(t.target).delete(t.key)}he.clear()}),he.add(e)}function Ze(e,t){Ye(e),t.clearValue&&(e.value=void 0,e.lastValue=void 0),t.deleteEntry&&qt(e)}function be(e,t,n={}){const o=z(e,t);Ze(o,n)}function et(e,t={}){const n=G.get(e);if(n)for(const o of n.values())Ze(o,t)}function tt(e,t){return{get:t?n=>{const o=e(n),i=n.shadowRoot||n.attachShadow({mode:"open",delegatesFocus:e.delegatesFocus||!1});return()=>(o(n,i),i)}:n=>{const o=e(n);return()=>(o(n,n),n)},observe(n,o){o()}}}const nt={string:(e,t,n)=>{const o=t?String(t):"";return o?e.setAttribute(n,o):e.removeAttribute(n),o},number:(e,t,n)=>{const o=Number(t);return e.setAttribute(n,o),o},boolean:(e,t,n)=>{const o=!!t;return o?e.setAttribute(n,""):e.removeAttribute(n),o},undefined:(e,t,n)=>{const o=typeof t,i=o!=="undefined"&&nt[o];return i?i(e,t,n):(e.hasAttribute(n)&&e.removeAttribute(n),t)}},Kt={string:(e,t)=>e.getAttribute(t),number:(e,t)=>Number(e.getAttribute(t))||0,boolean:(e,t)=>e.hasAttribute(t),undefined:(e,t)=>e.getAttribute(t)};function Gt(e,t){const n=typeof t.value,o=nt[n],i=Kt[n];if(!o)throw TypeError(`Invalid default value for '${e}' property - it must be a string, number, boolean or undefined: ${n}`);const r=q(e);return{get:(s,c)=>c===void 0?i(s,r)||t.value:c,set:(s,c)=>o(s,c,r),connect:n!=="undefined"?(s,c,f)=>(!s.hasAttribute(r)&&s[c]===t.value&&(s[c]=o(s,t.value,r)),t.connect&&t.connect(s,c,f)):t.connect,observe:t.observe}}const Y=new WeakMap,me=new WeakMap;function je(e,t){if(t){const r=Y.get(t);if(e===r)return t;for(const s of Object.keys(r))s!=="tag"&&delete t.prototype[s]}else t=class extends globalThis.HTMLElement{connectedCallback(){for(const s of t.settable){if(!hasOwnProperty.call(this,s))continue;const c=this[s];delete this[s],this[s]=c}const r=new Set;me.set(this,r),He(()=>{if(r===me.get(this)){for(const s of t.connects)r.add(s(this));for(const s of t.observers)r.add(s(this))}})}disconnectedCallback(){const r=me.get(this);for(const s of r)s&&s();me.delete(this),et(this)}};Y.set(t,Object.freeze(e));const n=new Set,o=new Set,i=new Set;for(const r of Object.keys(e)){if(r==="tag")continue;let s=e[r];const c=typeof s;if(c==="function")r==="render"?s=tt(s,!0):r==="content"?s=tt(s):s={get:s};else if(c!=="object"||s===null)s={value:s};else if(s.set){if(hasOwnProperty.call(s,"value"))throw TypeError(`Invalid property descriptor for '${r}' property - it must not have 'value' and 'set' properties at the same time.`);const f=q(r),h=s.get||((b,l)=>l);s.get=(b,l)=>(l===void 0&&(l=s.set(b,b.getAttribute(f)||l)),h(b,l))}if(hasOwnProperty.call(s,"value"))s=Gt(r,s);else if(!s.get)throw TypeError(`Invalid descriptor for '${r}' property - it must contain 'value' or 'get' option`);s.set&&i.add(r),Object.defineProperty(t.prototype,r,{get:function(){return D(this,r,s.get)},set:s.set&&function(h){pe(this,r,s.set,h)},enumerable:!0,configurable:!0}),s.connect&&n.add(f=>s.connect(f,r,()=>{be(f,r)})),s.observe&&o.add(f=>Jt(f,r,s.get,s.observe))}return t.connects=n,t.observers=o,t.settable=i,t}const Q=new Map;function Ht(e){Q.size||de.then(()=>{ue(globalThis.document.body,t=>{if(Q.has(t.constructor)){const n=Q.get(t.constructor),o=Y.get(t.constructor);t.disconnectedCallback();for(const i of Object.keys(o)){const r=typeof o[i],s=r!=="object"&&r!=="function"&&o[i]!==n[i];s&&t.removeAttribute(q(i)),be(t,i,{clearValue:s})}t.connectedCallback()}}),Q.clear()}),Q.set(e,Y.get(e))}function ot(e){if(!e.tag)throw TypeError("Error while defining hybrids: 'tag' property with dashed tag name is required");const t=globalThis.customElements.get(e.tag);if(t){if(Y.get(t))return Ht(t),je(e,t),e;throw TypeError(`Custom element with '${e.tag}' tag name already defined outside of the hybrids context`)}return globalThis.customElements.define(e.tag,je(e)),e}function Yt(e,{root:t="",prefix:n}={}){for(const o of Object.keys(e)){const i=e[o];if(!i.tag){const r=q([].concat(t).reduce((s,c)=>s.replace(c,""),o).replace(/^[./]+/,"").replace(/\//g,"-").replace(/\.[a-zA-Z]+$/,""));i.tag=n?`${n}-${r}`:r}ot(i)}return e}const Ce=Object.freeze(Object.assign(ot,{compile:e=>je(e),from:Yt})),Pe=Symbol("store.connect"),x=new WeakMap,ge=new WeakMap,rt=new WeakSet;function Ae(e,t,n){if(n&&(x.set(n,null),ge.set(n,t)),x.set(t,e),e.storage.observe){const o=t&&e.isInstance(t)?t:null,i=n&&e.isInstance(n)?n:null;o!==i&&e.storage.observe(o,i)}return t}function Qt(e,t){return Object.keys(e).every(n=>e[n]===t[n])}function Zt(e,t,n){return Ae(e,t,n),e.invalidate&&(!n||re(t)||!e.isInstance(n)||!Qt(t,n))&&e.invalidate(),t}function W(e,t,n,o=!0){return pe(e,t,o?Zt:Ae,n),n}let ye;function C(){return ye||(ye=Date.now(),de.then(()=>{ye=void 0})),ye}const we=new WeakMap;function Le(e){let t=we.get(e);return t||(t=C(),we.set(e,t)),t}function ke(e){return we.set(e,C()),e}function it(e){return we.set(e,1),e}function Re(e){return globalThis.btoa(Array.from(e).reduce((t,n)=>Math.imul(31,t)+n.charCodeAt(0)|0,0))}const Me="hybrids:store:cache",_e={};let ze;function en(e,t){const n=`${Me}:${Re(JSON.stringify(e.model))}`;return _e[n]=C()+t,ze||(ze=Promise.resolve().then(()=>{const o=JSON.parse(globalThis.localStorage.getItem(Me))||{},i=C();for(const r of Object.keys(o))!_e[r]&&o[r]<i&&(globalThis.localStorage.removeItem(r),delete o[r]);globalThis.localStorage.setItem(Me,JSON.stringify({...o,..._e})),ze=null})),n}const tn=/^\{.+\}$/;function st(e,t){typeof t=="function"&&(t={get:t});const n={cache:!0,loose:!1,...t};if(n.observe){const o=n.observe;if(typeof o!="function")throw TypeError(`Storage 'observe' property must be a function: ${typeof n.observe}`);n.observe=(i,r)=>{try{let s=r?r.id:i.id;if(tn.test(s))try{s=JSON.parse(s)}catch{}o(s,i,r)}catch(s){console.error(s)}}}if(n.cache===!1||n.cache===0)n.validate=o=>!o||Le(o)===C();else if(typeof n.cache=="number")n.validate=o=>!o||Le(o)+n.cache>C();else{if(n.cache!==!0)throw TypeError(`Storage 'cache' property must be a boolean or number: ${typeof n.cache}`);n.validate=o=>Le(o)!==1}if(n.get||(n.get=o=>{throw te(ee(o))}),n.offline)try{const o=n.offline===!0,i=o?1e3*60*60*24*30:n.offline,r=en(e,i),s=JSON.parse(globalThis.localStorage.getItem(r))||{};let c;n.offline=Object.freeze({key:r,threshold:i,get:o?f=>hasOwnProperty.call(s,f)?JSON.parse(s[f][1]):null:f=>{if(hasOwnProperty.call(s,f)){const h=s[f];return h[0]+i<C()?(delete s[f],null):JSON.parse(h[1])}return null},set(f,h){return h?s[f]=[C(),JSON.stringify(h,function(l,a){if(a===this[""])return a;if(a&&typeof a=="object"){const p=x.get(a);if(p===e&&a.id===f)return String(a);if(p&&p.storage.offline)return p.list?a.map(d=>(ve.get(p.model).storage.offline.set(d.id,d),`${d}`)):(p.storage.offline.set(a.id,a),`${a}`)}return a})]:delete s[f],c||(c=Promise.resolve().then(()=>{const b=C();for(const l of Object.keys(s))s[l][0]+i<b&&delete s[l];globalThis.localStorage.setItem(r,JSON.stringify(s)),c=null})),h}})}catch(o){console.error("Error while setup offline cache",o),n.offline=!1}return Object.freeze(n)}function nn(e){return{get:e.enumerable?()=>{}:()=>e.create({}),set:e.enumerable?(t,n)=>n:(t,n)=>n===null?{id:t}:n,list:e.enumerable&&function(n){if(n)throw TypeError("Memory-based model definition does not support id");const o=[];for(const{key:i,value:r}of Qe(e))i!==e&&r&&!re(r)&&o.push(i);return o},loose:!0}}function R(e,t){return Array.isArray(e)?cn(e[0],t):ft(e,t)}function lt(e,t){switch(e){case"string":return n=>n!=null?String(n):"";case"number":return Number;case"boolean":return Boolean;default:throw TypeError(`The value of the '${t}' must be a string, number or boolean: ${e}`)}}const on=(e,t,n)=>t.state==="error"?{state:"error",error:t.value}:(t.error=!!n&&n.error,t);function M(e,t,n=e){return pe(e,"state",on,{state:t,value:n}),e}const rn=(e,t={state:"ready",value:e,error:!1})=>t;function Z(e){return D(e,"state",rn)}function at(e){return e?(e^Math.random()*16>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,at)}function sn(e){if(typeof e!="function")throw TypeError(`The first argument must be a function: ${typeof e}`);return rt.add(e),e}const ct=new WeakMap;function ln(e,t,n){let o=n.model[t];rt.has(o)&&(o=o());let i=typeof o;if(o instanceof String||o instanceof Number||o instanceof Boolean){const r=ct.get(o);if(!r)throw TypeError(P(e,`You must use primitive ${typeof o.valueOf()} value for '${t}' property of the provided model definition`));o=o.valueOf(),i=typeof o,n.checks.set(t,r)}return{defaultValue:o,type:i}}function P(e,t){return`${t}

Model = ${JSON.stringify(e,null,2)}
`}const an=Promise.resolve(),ve=new WeakMap;function ft(e,t){if(typeof e!="object"||e===null)throw TypeError(`Model definition must be an object: ${typeof e}`);let n=ve.get(e);if(n&&!n.enumerable){if(t&&!n.nested)throw TypeError(P(e,"Provided model definition for nested object already used as a root definition"));if(!t&&n.nested)throw TypeError(P(e,"Nested model definition cannot be used outside of the parent definition"))}if(!n){const o=e[Pe];typeof o=="object"&&Object.freeze(o);let i;const r=hasOwnProperty.call(e,"id"),s=!!o,c=new Map,f={};Object.defineProperty(f,"toString",{value:function(){return this.id}});const h=Object.create(f);n={model:e,external:s,enumerable:r,nested:!r&&!s&&t,placeholder:l=>{const a=Object.create(h);return x.set(a,n),r&&(a.id=l),Object.freeze(a)},isInstance:l=>Object.getPrototypeOf(l)!==h,invalidate:()=>{i||(i=an.then(()=>{be(n,n,{clearValue:!0}),i=null}))},checks:c},ve.set(e,n),n.storage=st(n,o||nn(n));const b=Object.keys(Object.freeze(e)).map(l=>{if(l!=="id"&&Object.defineProperty(h,l,{get(){throw Error(`Model instance in ${Z(this).state} state - use store.pending(), store.error(), or store.ready() guards`)},enumerable:!0}),l==="id"){if(e[l]!==!0)throw TypeError("The 'id' property in the model definition must be set to 'true' or not be defined");return(u,d,y)=>{let g;hasOwnProperty.call(d,"id")?g=ee(d.id):y?g=y.id:g=at(),Object.defineProperty(u,"id",{value:g,enumerable:!0})}}const{defaultValue:a,type:p}=ln(e,l,n);switch(p){case"function":return u=>{Object.defineProperty(u,l,{get(){return D(this,l,()=>a(this))}})};case"object":{if(a===null)throw TypeError(`The value for the '${l}' must be an object instance: ${a}`);if(Array.isArray(a)){const y=typeof a[0];if(y!=="object"){if(y==="function"&&![String,Number,Boolean].includes(a[0]))throw TypeError(`The array item for the '${l}' must be one of the primitive types constructor: String, Number, or Boolean`);const w=y==="function"?a[0]:lt(y,l),m=y==="function"?[]:Object.freeze(a.map(w));return(v,$,T)=>{if(hasOwnProperty.call($,l)){if(!Array.isArray($[l]))throw TypeError(`The value for '${l}' property must be an array: ${typeof $[l]}`);v[l]=Object.freeze($[l].map(w))}else T&&hasOwnProperty.call(T,l)?v[l]=T[l]:v[l]=m}}const g=R(a,!0);if(g.external&&n.storage.offline&&g.storage.offline&&g.storage.offline.threshold<n.storage.offline.threshold)throw Error(`External nested model for '${l}' property has lower offline threshold (${g.storage.offline.threshold} ms) than the parent definition (${n.storage.offline.threshold} ms)`);if(g.enumerable&&a[1]){const w=a[1];if(typeof w!="object")throw TypeError(`Options for '${l}' array property must be an object instance: ${typeof w}`);w.loose&&(n.contexts=n.contexts||new Set,n.contexts.add(R(a[0])))}return(w,m,v)=>{if(hasOwnProperty.call(m,l)){if(!Array.isArray(m[l]))throw TypeError(`The value for '${l}' property must be an array: ${typeof m[l]}`);w[l]=g.create(m[l],!0)}else w[l]=v&&v[l]||!g.enumerable&&g.create(a)||[]}}const d=R(a,!0);if(d.enumerable||d.external){if(n.storage.offline&&d.storage.offline&&d.storage.offline.threshold<n.storage.offline.threshold)throw Error(`External nested model for '${l}' property has lower offline threshold (${d.storage.offline.threshold} ms) than the parent definition (${n.storage.offline.threshold} ms)`);return(y,g,w)=>{let m;if(hasOwnProperty.call(g,l)){const v=g[l];if(typeof v!="object"||v===null)v!=null&&(m={id:v});else{const $=x.get(v);if($){if($.model!==a)throw TypeError("Model instance must match the definition");m=v}else{const T=z(d,g[l].id).value;m=d.create(v,T&&d.isInstance(T)?T:void 0),W(d,m.id,m)}}}else m=w&&w[l];if(m){const v=m.id;Object.defineProperty(y,l,{get(){return D(this,l,()=>A(a,v))},enumerable:!0})}else y[l]=void 0}}return(y,g,w)=>{hasOwnProperty.call(g,l)?y[l]=g[l]===null?d.create({}):d.create(g[l],w&&w[l]):y[l]=w?w[l]:d.create({})}}default:{const u=lt(p,l);return(d,y,g)=>{hasOwnProperty.call(y,l)?d[l]=u(y[l]):g&&hasOwnProperty.call(g,l)?d[l]=g[l]:d[l]=a}}}});n.create=function(a,p){if(a===null)return null;if(typeof a!="object")throw TypeError(`Model values must be an object instance: ${a}`);const u=Object.create(f);for(const d of b)d(u,a,p);return x.set(u,n),Oe.set(u,Be),Object.freeze(u)},Object.freeze(h),Object.freeze(n)}return n}const ut=Object.getOwnPropertyNames(Array.prototype).reduce((e,t)=>(t==="length"||t==="constructor"||Object.defineProperty(e,t,{get(){throw Error(`Model list instance in ${Z(this).state} state - use store.pending(), store.error(), or store.ready() guards`)}}),e),[]),De=new WeakMap;function cn(e,t){let n=De.get(e);if(n&&!n.enumerable&&!t&&n.nested)throw TypeError(P(e,"Nested model definition cannot be used outside of the parent definition"));if(!n){const o=ft(e),i=new Set;if(o.storage.loose&&i.add(o),!t){if(!o.enumerable)throw TypeError(P(e,"Provided model definition does not support listing (it must be enumerable - set `id` property to `true`)"));if(!o.storage.list)throw TypeError(P(e,"Provided model definition storage does not support `list` action"))}t=!o.enumerable&&!o.external&&t,n={list:!0,nested:t,model:e,contexts:i,enumerable:o.enumerable,external:o.external,placeholder:()=>{const r=Object.create(ut);return x.set(r,n),Object.freeze(r)},isInstance:r=>Object.getPrototypeOf(r)!==ut,create(r,s=!1){if(r===null)return null;const c=[];for(const f of r){let h=f;if(typeof f=="object"&&f!==null){h=f.id;const b=x.get(f);let l=f;if(b){if(b.model!==e)throw TypeError("Model instance must match the definition")}else{const a=o.enumerable&&z(o,f.id).value;l=o.create(f,a&&o.isInstance(a)?a:void 0),o.enumerable&&(h=l.id,W(o,h,l,s))}o.enumerable||c.push(l)}else if(!o.enumerable)throw TypeError(`Model instance must be an object: ${typeof f}`);if(o.enumerable){const b=c.length;Object.defineProperty(c,b,{get(){return D(this,b,()=>A(e,h))},enumerable:!0})}}return Object.defineProperties(c,{id:{value:r.id},toString:{value:function(){return this.id}}}),x.set(c,n),Oe.set(c,Be),Object.freeze(c)}},n.storage=Object.freeze({...st(n,{cache:o.storage.cache,get:!t&&(r=>o.storage.list(r))}),offline:o.storage.offline&&{threshold:o.storage.offline.threshold,get:r=>{const s=ee(r);let c=o.storage.offline.get(Re(String(s)));return c?(c=c.map(f=>o.storage.offline.get(f)),c.id=s,c):null},set:(r,s)=>{o.storage.offline.set(Re(String(ee(r))),s.map(c=>(o.storage.offline.set(c.id,c),c.id)))}}}),De.set(e,Object.freeze(n))}return n}function fn(e,t){return t||C()}function ee(e){switch(typeof e){case"object":{const t={};for(const n of Object.keys(e).sort()){if(typeof e[n]=="object"&&e[n]!==null)throw TypeError(`You must use primitive value for '${n}' key: ${typeof e[n]}`);t[n]=e[n]}return JSON.stringify(t)}case"undefined":return;default:return String(e)}}const dt=new WeakSet;function te(e,t){const n=Error(P(e,`Model instance ${t!==void 0?`with '${t}' id `:""}does not exist`));return dt.add(n),n}function Te(e,t,n){return n!==!1&&!dt.has(t)&&console.error(t),M(e,"error",t)}function A(e,t){const n=R(e);let o;if(n.enumerable){if(o=ee(t),!o&&!n.list&&!ne.get(n))throw TypeError(P(e,`Provided model definition requires non-empty id: "${o}"`))}else if(t!==void 0)throw TypeError(P(e,"Provided model definition does not support id"));const i=n.storage.offline,r=n.storage.validate,s=z(n,o);return s.value&&!r(s.value)&&(s.resolved=!1),D(n,o,(c,f)=>{if(f&&F(f))return f;let h=!0;if(n.contexts)for(const l of n.contexts)D(l,l,fn)===C()&&(h=!1);if(h&&f&&r(f))return f;const b=()=>f||i&&n.create(i.get(o))||n.placeholder(o);try{let l=n.storage.get(t);if(typeof l!="object"||l===null)throw i&&i.set(o,null),te(e,o);if(l instanceof Promise)return l=l.then(p=>{if(typeof p!="object"||p===null)throw i&&i.set(o,null),te(e,o);p.id!==o&&(p.id=o);const u=n.create(p);return i&&i.set(o,u),W(n,o,ke(u))}).catch(p=>W(n,o,Te(b(),p))),M(b(),"pending",l);l.id!==o&&(l.id=o);const a=n.create(l);return i&&Promise.resolve().then(()=>{i.set(o,a)}),Ae(n,ke(a),f)}catch(l){return ke(Te(b(),l))}})}const ne=new WeakMap;function pt(e){const t=Object.keys(e),n=Error(`Model validation failed (${t.join(", ")}) - read the details from 'errors' property`);return n.errors=e,n}function oe(e,t={}){let n=x.get(e);if(n===null&&(e=ge.get(e),n=x.get(e)),n===null)throw Error("Provided model instance has expired. Haven't you used stale value?");let o=!!n;if(n||(n=R(e)),n.nested)throw P(n.model,TypeError("Setting provided nested model instance is not supported, use the root model instance"));if(n.list)throw TypeError("Listing model definition does not support 'set' method");if(!n.storage.set)throw P(n.model,TypeError("Provided model definition storage does not support 'set' method"));if(!o&&!n.enumerable&&(o=!0,e=A(e)),o){const s=F(e);if(s)return s.then(c=>oe(c,t))}const i=ne.get(n);let r;try{if(n.enumerable&&!o&&(!t||typeof t!="object"))throw TypeError(`Values must be an object instance: ${t}`);if(!i&&t&&hasOwnProperty.call(t,"id"))throw TypeError(`Values must not contain 'id' property: ${t.id}`);const s=n.create(t,o?e:void 0),c=t?Object.keys(t):[],f={},h=o&&i&&re(e);let b=!1;if(s){for(const[a,p]of n.checks.entries()){if(c.indexOf(a)===-1&&(h&&h.errors&&h.errors[a]&&(b=!0,f[a]=h.errors[a]),i&&s[a]==n.model[a]))continue;let u;try{u=p(s[a],a,s)}catch(d){u=d}u!==!0&&u!==void 0&&(b=!0,f[a]=u||!0)}if(b&&!i)throw pt(f)}r=s?s.id:e.id;const l=Promise.resolve(n.storage.set(o?r:void 0,s,c)).then(a=>{const p=a===s?s:n.create(a);if(o&&p&&r!==p.id)throw TypeError(`Local and storage data must have the same id: '${r}', '${p.id}'`);let u=p?p.id:r;return b&&i&&M(p,"error",pt(f)),i&&o&&hasOwnProperty.call(a,"id")&&(!s||s.id!==e.id)?u=e.id:n.storage.offline&&n.storage.offline.set(u,p),W(n,u,p||Te(n.placeholder(u),te(n.model,r),!1),!0)}).catch(a=>{throw a=a!==void 0?a:Error("Undefined error"),o&&M(e,"error",a),a});return o&&M(e,"pending",l),l}catch(s){return o&&M(e,"error",s),Promise.reject(s)}}function un(e,t){if(typeof t!="object")throw TypeError(`Values must be an object instance: ${t}`);let n=x.get(e);if(n===null&&(e=ge.get(e),n=x.get(e)),n===null)throw Error("Provided model instance has expired. Haven't you used stale value?");if(n===void 0){if(!t)throw TypeError("Values must be defined for usage with model definition");n=R(e),e=void 0}else if(t&&hasOwnProperty.call(t,"id"))throw TypeError(`Values must not contain 'id' property: ${t.id}`);if(n.list)throw TypeError("Listing model definition is not supported in sync method");const o=n.create(t,e),i=t?o.id:e.id;return W(n,i,o||Te(n.placeholder(i),te(n.model,i),!1))}function We(e,t=!0){if(typeof e!="object"||e===null)throw TypeError(`The first argument must be a model instance or a model definition: ${e}`);let n=x.get(e);if(n===null)throw Error("Provided model instance has expired. Haven't you used stale value from the outer scope?");if(n){const o=t&&n.storage.offline;o&&o.set(e.id,null),it(e),be(n,e.id,{clearValue:t,deleteEntry:t})}else{if(!ve.get(e)&&!De.get(e[0]))throw Error("Model definition must be used before - passed argument is probably not a model definition");n=R(e);const o=t&&n.storage.offline;for(const i of Qe(n))o&&o.set(i.key,null),i.value&&it(i.value);et(n,{clearValue:t,deleteEntry:t})}}function F(...e){let t=!1;const n=e.map(o=>{try{const{state:i,value:r}=Z(o);if(i==="pending")return t=!0,r}catch{}return Promise.resolve(o)});return t&&(e.length>1?Promise.all(n):n[0])}function ht(e,t){e=ge.get(e)||e,x.get(e)||(e=A(e,t));const n=F(e);if(!n){const o=re(e);return o?Promise.reject(o):Promise.resolve(e)}return n.then(o=>ht(o))}function re(e,t){if(e===null||typeof e!="object")return!1;const n=Z(e);if(t!==void 0){const o=typeof n.error=="object"&&n.error&&n.error.errors;return t===null?!o&&n.error:o[t]}return n.error}function Ie(...e){return e.length>0&&e.every(t=>{const n=x.get(t);return!!(n&&n.isInstance(t))})}function bt(e,t){return e={...e,...t},delete e.id,e}function dn(e,t={}){const n=x.get(e);if(!n||!ne.has(n))throw TypeError(`Provided model instance is not a draft: ${e}`);if(F(e))throw Error("Model draft in pending state");const o=ne.get(n);let i;if(z(o,e.id).value){const r=A(o.model,e.id);i=Promise.resolve(F(r)||r).then(s=>oe(s,bt(e,t)))}else i=oe(o.model,bt(e,t));return i=i.then(r=>(M(e,"ready"),oe(e,r).then(()=>r))).catch(r=>(M(e,"error",r),Promise.reject(r))),M(e,"pending",i),i}function pn(e,t){return!!e||`${t} is required`}function hn(e,t=pn,n=""){switch(typeof e){case"string":e=new String(e);break;case"number":e=new Number(e);break;case"boolean":e=new Boolean(e);break;default:throw TypeError(`Default value must be a string, number or boolean: ${typeof e}`)}let o;if(t instanceof RegExp)o=i=>t.test(i)||n;else if(typeof t=="function")o=(...i)=>{const r=t(...i);return r!==!0&&r!==void 0&&n||r};else throw TypeError(`The second argument must be a RegExp instance or a function: ${typeof t}`);return ct.set(e,o),e}function bn(e){const t=x.get(e),n=Object.freeze(Object.create(e));return x.set(n,t),n}function Be(e,t={}){const n=R(e);if(t.id!==void 0&&typeof t.id!="function"){const i=t.id;t.id=r=>r[i]}if(t.id&&!n.enumerable)throw TypeError("Store factory for singleton model definition does not support 'id' option");let o;if(t.draft){if(n.list)throw TypeError("Draft mode is not supported for listing model definition");o=R({...e,[Pe]:{get(i){const r=A(n.model,i);return F(r)||r},set(i,r){return r===null?{id:i}:r}}}),ne.set(o,n),e=o.model}return!t.id&&n.enumerable&&!n.list?{get(i,r){const c=x.get(r)!==void 0?r.id:r;if(o&&r==null){const f=o.create({},{id:void 0});return W(o,void 0,f,!1),A(e,void 0)}return r?A(e,c):void 0},set:(i,r)=>r,connect:o?(i,r)=>()=>{const s=i[r];s&&s.id&&We(s,!0)}:void 0}:{get:(i,r)=>{const s=x.get(r),c=t.id&&t.id(i)||(s!==void 0?r.id:r);if(o&&!c&&r==null){const h=o.create({});return W(o,void 0,h,!1),A(e,void 0)}if(!n.list&&n.enumerable&&c===void 0)return;const f=A(e,c);if(f!==r&&Ie(r)&&!Ie(f)){const h=bn(r);return pe(h,"state",()=>Z(f)),h}return f},set:!t.id&&n.list||o&&!n.enumerable?(i,r)=>r:void 0,connect:o&&n.enumerable?(i,r)=>()=>{const s=i[r];s&&s.id&&We(s,!0)}:void 0}}const V=Object.freeze(Object.assign(Be,{connect:Pe,get:A,set:oe,sync:un,clear:We,pending:F,error:re,ready:Ie,submit:dn,value:hn,resolve:ht,ref:sn})),ie=new WeakMap;function I(e){let t=ie.get(e);return t||(ie.set(e,t={}),t)}function $e(e){let t;for(;e&&(t=I(e))&&t.endNode;)e=t.endNode;return e}function se(e){if(e.nodeType===globalThis.Node.TEXT_NODE){const t=ie.get(e);if(t&&t.startNode){const n=$e(t.endNode);let o=t.startNode;const i=n.nextSibling;for(;o;){const r=o.nextSibling;o.parentNode.removeChild(o),o=r!==i&&r}ie.set(e,{})}}else{let t=e.childNodes[0];for(;t;)e.removeChild(t),t=e.childNodes[0];ie.set(e,{})}}const mn=Date.now(),_=(e=0)=>`H-${mn}-${e}`,Fe=!!(globalThis.document&&globalThis.document.adoptedStyleSheets),Ve=/^\d+$/,gn={block:(e,t)=>({display:"block","text-align":t}),inline:({display:e})=>({display:`inline${e?`-${e}`:""}`}),contents:{display:"contents"},hidden:{display:"none"},...["row","row-reverse","column","column-reverse"].reduce((e,t)=>(e[t]=(n,o="nowrap")=>({display:"flex","flex-flow":`${t} ${o}`}),e),{}),grow:(e,t=1)=>({"flex-grow":t}),shrink:(e,t=1)=>({"flex-shrink":t}),basis:(e,t)=>({"flex-basis":E(t)}),order:(e,t=0)=>({order:t}),grid:(e,t="1",n="",o="",i="")=>({display:"grid",...["columns","rows"].reduce((r,s)=>{const c=s==="columns"?t:n;return r[`grid-template-${s}`]=c&&c.split("|").map(f=>f.match(Ve)?`repeat(${f}, minmax(0, 1fr))`:E(f)).join(" "),r},{}),"grid-auto-flow":`${o} ${i&&"dense"}`}),area:(e,t="",n="")=>({"grid-column":t.match(Ve)?`span ${t}`:t,"grid-row":n.match(Ve)?`span ${n}`:n}),gap:(e,t=1,n="")=>({"column-gap":E(t),"row-gap":E(n||t)}),items:(e,t="start",n="")=>({"place-items":`${t} ${n}`}),content:(e,t="start",n="")=>({"place-content":`${t} ${n}`}),self:(e,t="start",n="")=>({"place-self":`${t} ${n}`}),center:{"place-items":"center","place-content":"center"},size:(e,t,n=t)=>({width:E(t),height:E(n),"box-sizing":"border-box"}),width:(e,t,n,o)=>({width:E(t),"min-width":E(n),"max-width":E(o),"box-sizing":"border-box"}),height:(e,t,n,o)=>({height:E(t),"min-height":E(n),"max-height":E(o),"box-sizing":"border-box"}),ratio:(e,t)=>({"aspect-ratio":t}),overflow:(e,t="hidden",n="")=>{const o=n?`-${t}`:"",i=n||t;return{[`overflow${o}`]:i,...i==="scroll"?{"flex-grow":e["flex-grow"]||1,"flex-basis":0,"overscroll-behavior":"contain","--webkit-overflow-scrolling":"touch"}:{}}},margin:(e,t="1",n,o,i)=>t.match(/top|bottom|left|right/)?{[`margin-${t}`]:E(n||"1")}:{margin:`${E(t)} ${E(n)} ${E(o)} ${E(i)}`},padding:(e,t="1",n,o,i)=>t.match(/top|bottom|left|right/)?{[`padding-${t}`]:E(n||"1")}:{padding:`${E(t)} ${E(n)} ${E(o)} ${E(i)}`},absolute:{position:"absolute"},relative:{position:"relative"},fixed:{position:"fixed"},sticky:{position:"sticky"},static:{position:"static"},inset:(e,t=0)=>{const n=E(t);return{top:n,right:n,bottom:n,left:n}},top:(e,t=0)=>({top:E(t)}),bottom:(e,t=0)=>({bottom:E(t)}),left:(e,t=0)=>({left:E(t)}),right:(e,t=0)=>({right:E(t)}),layer:(e,t=1)=>({"z-index":t}),"":(e,t,...n)=>{if(n.length<2)throw new Error("Generic rule '::' requires at least two arguments, eg.: ::[property]:[name]");return{[n[n.length-2]]:`var(--${n.join("-")})`}},view:(e,t)=>({"view-transition-name":t})},yn={min:"min-content",max:"max-content",fit:"fit-content",full:"100%"},wn={portrait:"orientation: portrait",landscape:"orientation: landscape"};function E(e){return e=yn[e]||e,/^-?\d+(\.\d+)*$/.test(String(e))?`${e*8}px`:e||""}let U;function mt(){if(U)return U;if(Fe)U=new globalThis.CSSStyleSheet;else{const e=globalThis.document.createElement("style");e.appendChild(globalThis.document.createTextNode("")),globalThis.document.head.appendChild(e),U=e.sheet}return U.insertRule(":host([hidden]) { display: none; }"),U}const gt=new WeakMap;let Ue=new WeakSet;function vn(e){const t=e.getRootNode();if(Ue.has(t))return;const n=mt();if(Fe)t.adoptedStyleSheets=[...t.adoptedStyleSheets,n];else{if(t===globalThis.document)return;let o=gt.get(t);o||(o=globalThis.document.createElement("style"),t.appendChild(o),gt.set(t,o));let i="";for(let r=0;r<n.cssRules.length;r++)i+=n.cssRules[r].cssText;o.textContent=i}Ue.add(t)}const yt=new Map;function wt(e,t,n,o){let i=yt.get(e);i||(i=`l-${Math.random().toString(36).substr(2,5)}`,yt.set(e,i)),Fe||(Ue=new WeakSet);const r=mt(),[s,c=""]=t.split("@"),f=Object.entries(n.replace(/\s+/g," ").trim().split(" ").reduce((b,l)=>{const[a,...p]=l.split(":"),u=gn[a];if(!u)throw TypeError(`Unsupported layout rule: '${a}'`);return Object.assign(b,typeof u=="function"?u(b,...p.map(d=>d.match(/--.*/)?`var(${d})`:d)):u)},{})).reduce((b,[l,a])=>a!==void 0&&a!==""?b+`${l}: ${a};`:b,""),h=c.split(":").reduce((b,l)=>l===""?b:b+` and (${wn[l]||`min-width: ${l}`})`,"@media screen");if(o){const b=`:host(.${i}-s${s})`,l=`:where(.${i}-c${s})`;[b,l].forEach(a=>{r.insertRule(c?`${h} { ${a} { ${f} } }`:`${a} { ${f} }`,r.cssRules.length-1)})}else{const b=`.${i}${s}`;r.insertRule(c?`${h} { ${b} { ${f} } }`:`${b} { ${f} }`,r.cssRules.length-1)}return i}const Xe=new WeakMap;function Tn(e,t){const n=I(e),o=n.startNode,i=$e(n.endNode);t.parentNode.insertBefore(e,t.nextSibling);let r=e,s=o;for(;s;){const c=s.nextSibling;r.parentNode.insertBefore(s,r.nextSibling),r=s,s=c!==i.nextSibling&&c}}function $n(e,t,n,o,i){let r=Xe.get(t);const s=n.map((b,l)=>({id:hasOwnProperty.call(b,"id")?b.id:l,value:b,placeholder:null,available:!0}));if(Xe.set(t,s),r){const b=new Set;for(const l of s)b.add(l.id);r=r.filter(l=>b.has(l.id)?!0:(se(l.placeholder),l.placeholder.parentNode.removeChild(l.placeholder),!1))}let c=t;const f=n.length-1,h=I(t);for(let b=0;b<s.length;b+=1){const l=s[b];let a;if(r){for(let p=0;p<r.length;p+=1)if(r[p].available&&r[p].id===l.id){a=r[p];break}}a?(a.available=!1,l.placeholder=a.placeholder,l.placeholder.previousSibling!==c&&Tn(l.placeholder,c),a.value!==l.value&&o(e,l.placeholder,l.value,a.value,i)):(l.placeholder=globalThis.document.createTextNode(""),c.parentNode.insertBefore(l.placeholder,c.nextSibling),o(e,l.placeholder,l.value,void 0,i)),c=$e(I(l.placeholder).endNode||l.placeholder),b===0&&(h.startNode=l.placeholder),b===f&&(h.endNode=c)}if(r)for(const b of r)b.available&&(se(b.placeholder),b.placeholder.parentNode.removeChild(b.placeholder))}function Sn(e,t,n){se(t);const o=I(t);o.startNode=o.endNode=n,t.parentNode.insertBefore(n,t.nextSibling)}function vt(e){const t=typeof e;if(t==="object"){if(Array.isArray(e))return"array";if(e instanceof globalThis.Node)return"node"}return t}function le(e,t,n,o,i){const r=vt(n),s=vt(o);switch(s!=="undefined"&&r!==s&&(r!=="function"&&se(t),s==="array"?Xe.delete(t):s!=="node"&&s!=="function"&&(t.textContent="")),r){case"array":$n(e,t,n,le,i);break;case"node":Sn(e,t,n);break;case"function":i&&(n.useLayout=!0),n(e,t);break;default:t.textContent=r==="number"||n?n:""}}const Je=new WeakMap;function En(e){return(t,n,o,i)=>{if(i){const r=Je.get(n);n.removeEventListener(e,r.get(i),i.options!==void 0?i.options:!1)}if(o){if(typeof o!="function")throw Error(`Event listener must be a function: ${typeof o}`);let r=Je.get(n);r||(r=new WeakMap,Je.set(n,r));const s=o.bind(null,t);r.set(o,s),n.addEventListener(e,s,o.options!==void 0?o.options:!1)}}}function xn(e,t=new Set){if(Array.isArray(e))for(const n of e)n&&t.add(n);else if(e!==null&&typeof e=="object")for(const[n,o]of Object.entries(e))n&&o&&t.add(n);else e&&t.add(e);return t}const Tt=new WeakMap;function On(e,t,n){const o=Tt.get(t)||new Set,i=xn(n);Tt.set(t,i);for(const r of i)t.classList.add(r),o.delete(r);for(const r of o)t.classList.remove(r)}const $t=new WeakMap;function Nn(e,t,n){if(n===null||typeof n!="object")throw TypeError(`Style value must be an object in ${fe(t)}:`,n);const o=$t.get(t)||new Map,i=new Map;for(const r of Object.keys(n)){const s=q(r),c=n[r];!c&&c!==0?t.style.removeProperty(s):t.style.setProperty(s,c),i.set(s,c),o.delete(s)}for(const r of o.keys())t.style[r]="";$t.set(t,i)}function jn(e,t,n){if(t.substr(0,2)==="on"){const o=t.substr(2);return En(o)}switch(e){case"class":return On;case"style":return Nn;default:{let o=!1;return(i,r,s)=>{if(o=o||!n&&!(r instanceof globalThis.SVGElement)&&t in r,o)r[t]=s;else if(s===!1||s===void 0||s===null)r.removeAttribute(e);else{const c=s===!0?"":String(s);r.setAttribute(e,c)}}}}}const St=_("(\\d+)"),ae=new RegExp(`^${St}$`),X=new RegExp(St,"g"),Cn=/^[^A-Za-z]+$/;function Pn(e){let t=e[0],n=!1;for(let o=1;o<e.length;o+=1)n=n||e[o-1].match(/<\s*(table|tr|thead|tbody|tfoot|colgroup)([^<>]|"[^"]*"|'[^']*')*>\s*$/),t+=(n?`<!--${_(o-1)}-->`:_(o-1))+e[o],n=n&&!e[o].match(/<\/\s*(table|tr|thead|tbody|tfoot|colgroup)\s*>/);return t}function An(e){return e.replace(/\s*=\s*['"]*$/g,"").split(/\s+/).pop()}function Et(e){return globalThis.document.createTreeWalker(e,globalThis.NodeFilter.SHOW_ELEMENT|globalThis.NodeFilter.SHOW_TEXT|globalThis.NodeFilter.SHOW_COMMENT,null,!1)}function Ln(e,t=0){e=e.replace(/(^[\n\s\t ]+)|([\n\s\t ]+$)+/g,"");let n=e.indexOf(`
`);if(n>-1){let o=0-t-2;for(n+=1;e[n]===" "&&n<e.length;n+=1)o+=1;return e.replace(/\n +/g,i=>i.substr(0,Math.max(i.length-o,1)))}return e}function xt(e,t){const n=_(t);return`${Ln(e).split(`
`).filter(i=>i).map(i=>{const r=i.indexOf(n);return r>-1?`| ${i}
--${"-".repeat(r)}${"^".repeat(6)}`:`| ${i}`}).join(`
`).replace(X,"${...}")}`}const Ot=new Map,Nt=new WeakMap;function kn(e,t){const n=Nt.get(e);if(!n&&!t)return;const o=t&&t.map(r=>{let s=r;return s instanceof globalThis.CSSStyleSheet||(s=Ot.get(r),s||(s=new globalThis.CSSStyleSheet,s.replaceSync(r),Ot.set(r,s))),s});let i;if(n){if(o&&o.length===n.length&&o.every((r,s)=>r===n[s]))return;i=e.adoptedStyleSheets.filter(r=>!n.includes(r))}o&&(i=(i||e.adoptedStyleSheets).concat(o)),e.adoptedStyleSheets=i,Nt.set(e,o)}const qe=new WeakMap;function jt(e,t){let n=qe.get(e);if(t){(!n||n.parentNode!==e)&&(n=globalThis.document.createElement("style"),qe.set(e,n),e=$e(e),e.nodeType===globalThis.Node.TEXT_NODE?e.parentNode.insertBefore(n,e.nextSibling):e.appendChild(n));const o=[...t].join(`
/*------*/
`);n.textContent!==o&&(n.textContent=o)}else n&&(n.parentNode.removeChild(n),qe.set(e,null))}const Ct=new WeakMap;function Rn(e,t){let n=Ct.get(e);n||(n=e.adoptedStyleSheets?kn:jt,Ct.set(e,n)),n(e,t)}function Mn(e,t,n,o){let i=globalThis.document.createElement("template");const r={},s=n?e:Pn(e);if(i.innerHTML=t?`<svg>${s}</svg>`:s,t){const u=i.content.firstChild;i.content.removeChild(u);for(const d of Array.from(u.childNodes))i.content.appendChild(d)}let c;const f=i.content.children[0];if(f instanceof globalThis.HTMLTemplateElement){for(const u of Array.from(f.attributes)){const d=u.value.trim();if(d&&u.name.startsWith("layout")){if(d.match(X))throw Error("Layout attribute cannot contain expressions");c=wt(f,u.name.substr(6),d,!0)}}if(c!==void 0&&i.content.children.length>1)throw Error("Template, which uses layout system must have only the '<template>' root element");o=c||f.hasAttribute("layout"),i=f}const h=Et(i.content),b=[];let l=0,a=null;for(;h.nextNode();){let u=h.currentNode;if(a&&!a.contains(u)&&(a=null),u.nodeType===globalThis.Node.COMMENT_NODE&&ae.test(u.textContent)&&(u.parentNode.insertBefore(globalThis.document.createTextNode(u.textContent),u.nextSibling),h.nextNode(),u.parentNode.removeChild(u),u=h.currentNode),u.nodeType===globalThis.Node.TEXT_NODE){let d=u.textContent;const y=d.match(ae);if(y)u.textContent="",r[y[1]]=[l,le];else{if(Qn()&&!n&&!a&&!d.match(/^\s*$/)){let w;const m=d.trim(),v=m.replace(/\s+/g," ").replace(X,($,T)=>(T=Number(T),w===void 0&&(w=T),`\${${T-w}}`));if(!v.match(Cn)){let $=u.previousSibling&&u.previousSibling.nodeType===globalThis.Node.COMMENT_NODE?u.previousSibling:"";$&&($.parentNode.removeChild($),l-=1,$=($.textContent.split("|")[1]||"").trim().replace(/\s+/g," "));const T=Zn(v,$).replace(/\${(\d+)}/g,(S,O)=>_(Number(O)+w));d=d.replace(m,T),u.textContent=d}}const g=d.match(X);if(g){let w=u;g.reduce((m,v)=>{const[$,T]=m.pop().split(v);return $&&m.push($),m.push(v),T&&m.push(T),m},[d]).forEach((m,v)=>{v===0?w.textContent=m:(w=w.parentNode.insertBefore(globalThis.document.createTextNode(m),w.nextSibling),h.currentNode=w,l+=1);const $=w.textContent.match(ae);$&&(w.textContent="",r[$[1]]=[l,le])})}}}else if(u.nodeType===globalThis.Node.ELEMENT_NODE){if(!a&&(u.getAttribute("translate")==="no"||u.tagName.toLowerCase()==="script"||u.tagName.toLowerCase()==="style")&&(a=u),Ne){const d=u.tagName.toLowerCase();d.match(/.+-.+/)&&!globalThis.customElements.get(d)&&!b.includes(d)&&b.push(d)}for(const d of Array.from(u.attributes)){const y=d.value.trim(),g=d.name;if(o&&g.startsWith("layout")&&y){if(y.match(X))throw Error("Layout attribute cannot contain expressions");const m=wt(u,g.substr(6),y);u.removeAttribute(g),u.classList.add(m);continue}const w=y.match(ae);if(w){const m=An(e[w[1]]);r[w[1]]=[l,jn(g,m,t)],u.removeAttribute(d.name)}else{const m=y.match(X);if(m){const v=`attr__${g}`;for(const[$,T]of m.entries()){const[,S]=T.match(ae);let O=!1;r[S]=[l,(L,N,k)=>{const B=I(N);B[v]=(B[v]||y).replace(T,k??""),(m.length===1||$+1===m.length)&&(O=O||!t&&!(N instanceof globalThis.SVGElement)&&g in N,O?N[g]=B[v]:N.setAttribute(g,B[v]),B[v]=void 0)}]}d.value=""}}}}l+=1}Ne&&b.length&&console.warn(`Not defined ${b.map(u=>`<${u}>`).join(", ")} element${b.length>1?"s":""} found in the template:
${xt(s,-1)}`);const p=Object.keys(r);return function(d,y,g,{styleSheets:w}){let m=I(y);if(i!==m.template){const v=globalThis.document.importNode(i.content,!0),$=Et(v),T=[];let S=0,O=0,L=r[p[O]];for(;$.nextNode();){const N=$.currentNode;for(;L&&L[0]===S;)T.push({index:p[O],node:N,fn:L[1]}),O+=1,L=r[p[O]];S+=1}if(m.hostLayout&&d.classList.remove(m.hostLayout),se(y),m=I(y),m.template=i,m.markers=T,y.nodeType===globalThis.Node.TEXT_NODE){jt(y),m.startNode=v.childNodes[0],m.endNode=v.childNodes[v.childNodes.length-1];let N=y,k=v.childNodes[0];for(;k;)y.parentNode.insertBefore(k,N.nextSibling),N=k,k=v.childNodes[0]}else{if(o){const N=`${c}-${d===y?"c":"s"}`;d.classList.add(N),m.hostLayout=N}y.appendChild(v)}o&&vn(y)}Rn(y,w);for(const v of m.markers){const $=g[v.index],T=m.prevArgs&&m.prevArgs[v.index];if(!(m.prevArgs&&$===T))try{v.fn(d,v.node,$,T,o)}catch(S){throw console.error(`Error while updating template expression in ${fe(d)}:
${xt(s,v.index)}`),S}}m.prevArgs=g}}const Ke=new WeakMap;function _n(e,t,n=200){return function o(i,r){const s=o.useLayout;let c;t&&(c=setTimeout(()=>{c=void 0,le(i,r,t,void 0,s)},n)),Ke.set(r,e),e.then(f=>{c&&clearTimeout(c),Ke.get(r)===e&&(le(i,r,f,t&&!c?t:void 0,s),Ke.set(r,null))})}}function Pt({target:e,detail:t},n){let o;switch(e.type){case"radio":case"checkbox":o=e.checked&&e.value;break;case"file":o=e.files;break;default:o=t&&hasOwnProperty.call(t,"value")?t.value:e.value}n(o)}function zn(e,t){return e.split(".").reverse().reduce((n,o)=>n?{[o]:n}:{[o]:t},null)}const At=new Map;function Dn(e,t){if(!e)throw Error(`The first argument must be a property name or an object instance: ${e}`);if(typeof e=="object"){if(t===void 0)throw Error("For model instance property the second argument must be defined");const o=Oe.get(e);if(!o)throw Error("Provided object must be a model instance of the store");return t===null?()=>{o.set(e,null)}:(i,r)=>{Pt(r,s=>{o.set(e,zn(t,s))})}}if(arguments.length===2)return o=>{o[e]=t};let n=At.get(e);return n||(n=(o,i)=>{Pt(i,r=>{o[e]=r})},At.set(e,n)),n}let Se;const Wn=globalThis.document&&globalThis.document.startViewTransition!==void 0&&function(t){return function n(o,i){if(Se){console.warn(`${fe(o)}: view transition already started in ${fe(Se)}`),t(o,i);return}t.useLayout=n.useLayout,Se=o,globalThis.document.startViewTransition(()=>(t(o,i),de.then(()=>{Se=void 0})))}}||(e=>e),In=Object.freeze(Object.defineProperty({__proto__:null,resolve:_n,set:Dn,transition:Wn},Symbol.toStringTag,{value:"Module"}));function Bn(e){return this.id=e,this}function Fn(...e){return this.styleSheets=this.styleSheets||[],this.styleSheets.push(...e),this}function Vn(e,...t){this.styleSheets=this.styleSheets||[];let n=e[0];for(let o=1;o<e.length;o++)n+=(t[o-1]!==void 0?t[o-1]:"")+e[o];return this.styleSheets.push(n),this}function Un(e){return this.plugins=this.plugins||[],this.plugins.push(e),this}const Xn=Object.freeze(Object.defineProperty({__proto__:null,css:Vn,key:Bn,style:Fn,use:Un},Symbol.toStringTag,{value:"Module"})),Jn=_(),qn=_("svg"),Kn=_("msg"),Gn=_("layout"),Lt=new Map;function Hn(e,t,n,o){function i(r,s=r){let c=o?e+Kn:e.join(Jn);n&&(c+=qn);const f=i.useLayout;f&&(c+=Gn);let h=Lt.get(c);h||(h=Mn(e,n,o,f),Lt.set(c,h)),i.plugins?i.plugins.reduce((b,l)=>l(b),()=>h(r,s,t,i))(r,s):h(r,s,t,i)}return Object.assign(i,Xn)}function Ee(e,...t){return Hn(e,t,!1,!1)}Object.freeze(Object.assign(Ee,In));const xe=new Map,kt=new Map;let Rt=null;const Yn=(()=>{let e;try{e=globalThis.navigator.languages||[globalThis.navigator.language]}catch{e=[]}return e.reduce((t,n)=>{const o=n.split("-")[0];return t.add(n),n!==o&&t.add(o),t},new Set)})();function Qn(){return Rt!==null||xe.size}const Mt=new Map;function Zn(e,t,n=[]){e=e.trim().replace(/\s+/g," "),t=t.trim();const o=`${e} | ${t}`;let i=kt.get(o);if(!i){if(xe.size)for(const r of Yn){const s=xe.get(r);if(s&&(i=s[o]||s[e],i)){if(i=i.message,typeof i=="object"){let c=Mt.get(r);c||(c=new Intl.PluralRules(r),Mt.set(r,c));const f=i;i=h=>h===0&&f.zero||f[c.select(h)]||f.other||""}break}}i||i||(i=e,(xe.size||Rt)&&Ne&&console.warn(`Missing translation: "${e}"${t?` [${t}]`:""}`)),kt.set(o,i)}return typeof i=="function"?i(n[0]):i}var _t=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ge={exports:{}};(function(e,t){(function(n,o){o(t)})(_t,function(n){const o=()=>{var a;return!!(!((a=navigator.mediaDevices)===null||a===void 0)&&a.getDisplayMedia)};/*! *****************************************************************************
  	    Copyright (c) Microsoft Corporation.

  	    Permission to use, copy, modify, and/or distribute this software for any
  	    purpose with or without fee is hereby granted.

  	    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  	    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  	    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  	    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  	    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  	    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  	    PERFORMANCE OF THIS SOFTWARE.
  	    ***************************************************************************** */function i(a,p,u,d){function y(g){return g instanceof u?g:new u(function(w){w(g)})}return new(u||(u=Promise))(function(g,w){function m(T){try{$(d.next(T))}catch(S){w(S)}}function v(T){try{$(d.throw(T))}catch(S){w(S)}}function $(T){T.done?g(T.value):y(T.value).then(m,v)}$((d=d.apply(a,p||[])).next())})}const r=a=>{const p=document.createElement("video");return p.autoplay=!0,p.muted=!0,p.playsInline=!0,p.srcObject=a,p.setAttribute("style","position:fixed;top:0;left:0;pointer-events:none;visibility:hidden;"),p},s=a=>{var p,u,d;const y=(p=a.srcObject)===null||p===void 0?void 0:p.getTracks()[0].getSettings(),g=document.createElement("canvas");g.width=(u=y==null?void 0:y.width)!==null&&u!==void 0?u:0,g.height=(d=y==null?void 0:y.height)!==null&&d!==void 0?d:0;const w=g.getContext("2d");return w==null||w.drawImage(a,0,0),g},c=a=>{const p=document.createElement("audio");p.loop=!1,p.src=a,p.play(),p.remove()},f=(a=300)=>new Promise(p=>{setTimeout(p,a)}),h=a=>{var p;const u=(p=a.srcObject)===null||p===void 0?void 0:p.getTracks();u==null||u.forEach(d=>d.stop()),a.srcObject=null,a.remove()},b=a=>i(void 0,void 0,void 0,function*(){return yield f(),document.hasFocus()?a:b(a)}),l=({onCaptureEnd:a,onCaptureStart:p,quality:u=.7,type:d="image/jpeg",soundEffectUrl:y}={})=>i(void 0,void 0,void 0,function*(){return yield p==null?void 0:p(),navigator.mediaDevices.getDisplayMedia({preferCurrentTab:!0,video:{frameRate:30}}).then(b).then(g=>i(void 0,void 0,void 0,function*(){const w=r(g);document.body.appendChild(w),y&&c(y),yield f();const m=s(w),v=m.toDataURL(d,u);return h(w),m.remove(),yield a==null?void 0:a(),v}))});n.checkIfBrowserSupported=o,n.takeScreenshot=l,Object.defineProperty(n,"__esModule",{value:!0})})})(Ge,Ge.exports);var zt=Ge.exports,eo={exports:{}};(function(e,t){(function(n,o){e.exports=o()})(_t,function(){return function n(o,i,r){var s=window,c="application/octet-stream",f=r||c,h=o,b=!i&&!r&&h,l=document.createElement("a"),a=function(S){return String(S)},p=s.Blob||s.MozBlob||s.WebKitBlob||a,u=i||"download",d,y;if(p=p.call?p.bind(s):Blob,String(this)==="true"&&(h=[h,f],f=h[0],h=h[1]),b&&b.length<2048&&(u=b.split("/").pop().split("?")[0],l.href=b,l.href.indexOf(b)!==-1)){var g=new XMLHttpRequest;return g.open("GET",b,!0),g.responseType="blob",g.onload=function(S){n(S.target.response,u,c)},setTimeout(function(){g.send()},0),g}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(h))if(h.length>1024*1024*1.999&&p!==a)h=$(h),f=h.type||c;else return navigator.msSaveBlob?navigator.msSaveBlob($(h),u):T(h);else if(/([\x80-\xff])/.test(h)){var w=0,m=new Uint8Array(h.length),v=m.length;for(w;w<v;++w)m[w]=h.charCodeAt(w);h=new p([m],{type:f})}d=h instanceof p?h:new p([h],{type:f});function $(S){var O=S.split(/[:;,]/),L=O[1],N=O[2]=="base64"?atob:decodeURIComponent,k=N(O.pop()),B=k.length,ce=0,Vt=new Uint8Array(B);for(ce;ce<B;++ce)Vt[ce]=k.charCodeAt(ce);return new p([Vt],{type:L})}function T(S,O){if("download"in l)return l.href=S,l.setAttribute("download",u),l.className="download-js-link",l.innerHTML="downloading...",l.style.display="none",document.body.appendChild(l),setTimeout(function(){l.click(),document.body.removeChild(l),O===!0&&setTimeout(function(){s.URL.revokeObjectURL(l.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(S)&&(S="data:"+S.replace(/^data:([\w\/\-\+]+)/,c)),window.open(S)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=S),!0;var L=document.createElement("iframe");document.body.appendChild(L),!O&&/^data:/.test(S)&&(S="data:"+S.replace(/^data:([\w\/\-\+]+)/,c)),L.src=S,setTimeout(function(){document.body.removeChild(L)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(d,u);if(s.URL)T(s.URL.createObjectURL(d),!0);else{if(typeof d=="string"||d.constructor===a)try{return T("data:"+f+";base64,"+s.btoa(d))}catch{return T("data:"+f+","+encodeURIComponent(d))}y=new FileReader,y.onload=function(S){T(this.result)},y.readAsDataURL(d)}return!0}})})(eo);const Dt="4a3fb7dc39032a123e911f41fc0c17e3",Wt="ATTA9c52ab7e727e26698f5ef71b9c2a1102cf0e598221b773cbfd549376ddc516661169EF54",to="https://api.trello.com/1",no=`key=${Dt}&token=${Wt}`,It={name:"Name",desc:"Description",expectedBehaviour:"Expected Behaviour"},Bt={name:"",desc:""};function oo(){const e=`
  **Name:** ${V.name}
  **Description:** ${V.desc}
  **Expected Behaviour:** ${V.expectedBehaviour}
  `;return{...V.get(Bt),desc:e,pos:"bottom"}}function ro(e){return fetch(e).then(t=>t.blob()).then(t=>new File([t],"Screenshot",{type:"image/png"}))}function io(e,t){const n=new FormData;n.append("name","Screenshot"),n.append("file",t),n.append("mimeType","image/png"),n.append("key",Dt),n.append("token",Wt);const o=new XMLHttpRequest;o.responseType="json",o.onreadystatechange=function(){o.readyState===4&&console.log(`Successfully uploaded at: ${o.response.date}`)},o.open("POST",`https://api.trello.com/1/cards/${cardId}/attachments/`),o.send(n)}function so(e,t){t.preventDefault();const n=`${to}/cards?idList=${e.idlist}&${no}`,o=oo();fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...V.get(o)})}).then(i=>i.json()).then(i=>{zt.checkIfBrowserSupported()&&zt.takeScreenshot().then(ro).then(r=>{console.log(r),io(i.id,r)})})}function Ft(e,t){V.set(Bt,{[t.target.name]:t.target.value})}Ce({tag:"lunar-bug-tool",idlist:"",render:()=>Ee`
    <div class="lunar-bug-tool">
      <h4>Report a bug</h4>
      <form onsubmit="${so}">
        <lunar-bug-tool-input name="name"></lunar-bug-tool-input>
        <lunar-bug-tool-textarea name="desc"></lunar-bug-tool-textarea>
        <lunar-bug-tool-textarea
          name="expectedBehaviour"
        ></lunar-bug-tool-textarea>

        <button>Submit</button>
      </form>
    </div>
  `.css`
    form {
      margin: .5rem 0;
    }

    .lunar-bug-tool {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      padding: 0 1rem .5rem;
      font-family: 'Gotham Rounded', Arial, sans-serif;
      background: linear-gradient(45deg, #272c40, #485b9c 200%);
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0,0,0,0.8);
    }

    .lunar-bug-tool h4 {
      color: white;
    }
  `}),Ce({tag:"lunar-bug-tool-input",name:"",value:"",render:({value:e,name:t})=>Ee`
    <div>
      <label>${It[t]}</label>
      <input
        type="text"
        name="${t}"
        value="${e}"
        oninput="${Ft}"
      />
    </div>
  `.css`
    label {
      display: block;
      color: white;
    }
    input {
      display: block;
      margin-bottom: 1rem;
    }
  `}),Ce({tag:"lunar-bug-tool-textarea",name:"",value:"",render:({value:e,name:t})=>Ee`
    <div>
      <label>${It[t]}</label>
      <textarea
        type="text"
        name="${t}"
        value="${e}"
        oninput="${Ft}"
      ></textarea>
    </div>
  `.css`
    label {
      display: block;
      color: white;
    }
    textarea {
      display: block;
      margin-bottom: 1rem;
    }
  `})});
